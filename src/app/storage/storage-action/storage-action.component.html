<app-storage-search>
</app-storage-search>

<div class="storage-action-container">

    <div class="storage-action">

        <div style="font-size: 14px;padding: 6px 0px 6px 12px;border-bottom: 1px solid rgba(0,0,0,.12);"
            *ngIf="storageBlock.entities[blockId]?.header?.predecessor">
            <button routerLink="/storage/{{ storageBlock.entities[blockId]?.header?.predecessor }}" mat-icon-button>
                <mat-icon>chevron_left</mat-icon>
            </button>
            <button routerLink="/storage/" *ngIf="storageBlock.entities[blockId]?.header?.predecessor" mat-icon-button>
                <mat-icon>chevron_right</mat-icon>
            </button>

            <span *ngIf="storageBlock.entities[blockId]?.header?.level">
                {{ storageBlock.entities[blockId]?.header?.level }}
            </span>

            <span *ngIf="storageBlock.entities[blockId]?.hash" style="padding-left: 12px;">
                {{ storageBlock.entities[blockId]?.hash }}
            </span>
        </div>

        <table mat-table [dataSource]="tableDataSource">

            <ng-container matColumnDef="time">
                <th mat-header-cell *matHeaderCellDef>Time</th>
                <td mat-cell *matCellDef="let action">
                    <!-- style="width:45px;display:inline-block;text-align:right;" -->
                    <span> {{action.id.Set?.timeStorage }} μs |</span>&nbsp;
                    <span> {{action.id.Set?.timeProtocol }} μs</span>&nbsp;
                </td>
            </ng-container>

            <ng-container matColumnDef="category">
                <th mat-header-cell *matHeaderCellDef>Category</th>
                <td mat-cell *matCellDef="let action">

                </td>
            </ng-container>

            <ng-container matColumnDef="path">
                <th mat-header-cell *matHeaderCellDef>
                    <span>Path</span>
                </th>
                <td mat-cell *matCellDef="let action">
                    <div>
                        <span [style.color]="action.id.Set?.color">
                            {{action.id.Set?.category }}
                        </span>
                        <span *ngIf="action?.id?.Set">
                            {{action.id.Set?.key}}
                        </span>
                        <!-- 
                            <span [style.color]="action.id.Set?.color"
                                *ngIf="action.id.Set?.lastKey">/{{ action.id.Set?.lastKey }}
                            </span>  
                        -->
                        <span *ngIf="action?.id?.Delete">
                            <span> {{action.id.Delete?.time }} μs |</span>&nbsp;
                            del <i>{{action.id.Delete?.key}}</i>
                        </span>
                        <span *ngIf="action?.id?.RemoveRecord">
                            <span> {{action.id.RemoveRecord?.time }} μs |</span>&nbsp;
                            rem <i>{{action.id.RemoveRecord?.key}} </i>
                        </span>
                    </div>
                    <div *ngIf="false">
                        <span style="display:flex; justify-content: flex-end;">
                        </span>
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="value">
                <th mat-header-cell *matHeaderCellDef>Value</th>
                <td mat-cell *matCellDef="let action">
                    <span *ngIf="action?.id?.Set" style="text-align: left">
                        <span *ngIf="action.id?.Set?.value">
                            <b>{{action.id?.Set?.value}}</b>
                        </span>
                        <span *ngIf="!action.id?.Set?.value">
                            {{action.id?.Set?.hex}} {{action.id?.Set?.text}}
                        </span>
                    </span>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['time','path','value']">
            </tr>
            <tr mat-row *matRowDef="let row; columns: ['time','path','value'];">
            </tr>

        </table>

        <mat-paginator [pageSizeOptions]="[100]"></mat-paginator>
    </div>

</div>


<!-- {{ storageAction.ids | json }} -->
<!-- <li *ngFor="let action of storageAction.entities">
    <span *ngIf="action?.Set">
        <b>set</b>: {{action.Set?.key}} - <b> {{action.Set?.value}} </b> | {{action.Set?.text}} | {{action.Set?.hex}}
    </span>
    <span *ngIf="action?.Delete">
        del:<i>{{action.Delete?.key}}</i>
    </span>
    <span *ngIf="action?.RemoveRecord">
        rem: <i>{{action.RemoveRecord?.key}} </i>
    </span>
</li> -->