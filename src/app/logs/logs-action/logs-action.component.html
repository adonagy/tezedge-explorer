<!-- <style>
    .logs-action-filter {
        width: 800px;
        padding: 10px 0px 10px 0px;
        height: 32px;

        display: flex;
        align-items: center;
        /*justify-content: center;*/
    }

    .logs-action-filter button {
        border:1px solid #e0e0e0;
        margin-right: 2px;
        line-height: 32px !important;
        font-weight: 300 !important;
        background-color: #f5f9fc;
        min-width: 154px;
    }
    .logs-action-filter button mat-icon {
        display: none;
    }

    .logs-action-filter button.active {
        background-color:white;
    }

    .logs-action-filter button.active mat-icon {
        display: inline-block;
        font-size: 18px;
        margin-left: -8px;
        height: 20px;
        width: 20px;
    }
   
    .logs-action-container {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
    }

    .logs-action th.mat-header-cell.cdk-column-datetime.mat-column-datetime {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
    }
    .logs-action .mat-cell.cdk-column-datetime.mat-column-datetime {
        width: 140px;
    }


    .logs-action th.mat-header-cell.cdk-column-address.mat-column-address {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
    }
    .logs-action .mat-cell.cdk-column-address.mat-column-address {
        width: 100px;
    }

    .logs-action th.mat-header-cell.cdk-column-level.mat-column-level {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
    }
    .logs-action .mat-cell.cdk-column-level.mat-column-level {
        width: 80px;
    }

    .logs-action th.mat-header-cell.cdk-column-message.mat-column-message {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
    }
    .logs-action .mat-cell.cdk-column-message.mat-column-message {
        padding-right: 10px;
    }

    .detail-colapsed {
        display: none;
    }

</style>

<div class="logs-action-container">
  
    <div class="logs-action">

        <table mat-table [dataSource]="tableDataSource" multiTemplateDataRows>

            <ng-container matColumnDef="datetime">
                <th mat-header-cell *matHeaderCellDef>Datetime</th>
                <td mat-cell *matCellDef="let element">
                    {{ element.datetime }}
                </td>
            </ng-container>

            <ng-container matColumnDef="level">
                <th mat-header-cell *matHeaderCellDef>Level</th>
                <td mat-cell *matCellDef="let element">
                    <a style="color:black;text-decoration: none;">
                        {{ element.level }} 
                    </a>
                </td>
            </ng-container>

            <ng-container matColumnDef="message">
                <th mat-header-cell *matHeaderCellDef>Message</th>
                <td mat-cell *matCellDef="let element">
                    <span *ngIf="element" style="text-align: left; cursor: pointer;"
                            (click)="expandedElement = element">
                        {{ element.message }}
                    </span>
                </td>
            </ng-container>

            <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let logsAction" [attr.colspan]="4" class="expanded-detail-cell">
                    <div *ngIf="expandedElement == logsAction" style="min-width: 700px;">
                        <mat-tab-group>
                            <mat-tab label="PREVIEW"> 
                                <div style="padding: 15px 20px 0px 20px">
                                    <ngx-json-viewer  [json]="logsAction.message" [expanded]="false">
                                    </ngx-json-viewer>
                                </div>
                            </mat-tab>
                          </mat-tab-group>
                        </div>    
                    </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['datetime','level','message']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['datetime','level','message'];"></tr>

            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
                [class.detail-expanded]="expandedElement == row" [class.detail-colapsed]="expandedElement != row">
            </tr>

        </table>

        <mat-paginator [pageSizeOptions]="[15]"></mat-paginator>
        
    </div>

</div> -->

<!--
<pre style="color:#f0f3f7">
    dataLength: {{ viewPortGetDataLength }}  
    offsetToRenderedContentStart: {{ viewPortGetOffsetToRenderedContentStart }}
    renderedRange: {{ viewPortGetRenderedRange | json }}
    viewPortGetViewportSize: {{ viewPortGetViewportSize }}
    measureRenderedContentSize: {{ viewPortMeasureRenderedContentSize }}
</pre> 
-->
<div class="logs-action-container">

<div class="table-virtual-scroll">
    <div class="table-virtual-scroll-header">
        <span style="display:inline-block;min-width: 170px;">Datetime</span>
        <span style="display:inline-block;min-width: 60px;">Level</span>
        <span style="display:inline-block;min-width: 725px;">Message</span>
    </div>
    <cdk-virtual-scroll-viewport [itemSize]="36" [maxBufferPx]="288" [minBufferPx]="288" class="table-virtual-scroll-viewport"
        (scrolledIndexChange)="onScroll($event)">
        <div *cdkVirtualFor="let item of logsActionList" class="table-virtual-scroll-item">
            <span style="display:inline-block;min-width: 170px">{{item?.datetime}}</span>
            <span style="display:inline-block;min-width: 60px">{{item?.level}}</span>
           <span style="display:inline-block;min-width: 725px;  white-space: nowrap;
           text-overflow: ellipsis;">{{item?.preview}}</span>
            <!-- <span style="display:inline-block;width: 200px">{{item.message}}</span>   -->
        </div>
    </cdk-virtual-scroll-viewport>
    <div class="table-virtual-scroll-footer" >
        <span >
            <button mat-icon-button matTooltip="Start" (click)="start()" *ngIf="!logsAction?.stream" >
                <mat-icon style="color: #737373">play_arrow_outline</mat-icon>
            </button>
            <button mat-icon-button matTooltip="Stop" (click)="stop()" *ngIf="logsAction?.stream">
                <mat-icon style="color:#737373">stop_outline</mat-icon>
            </button>
            <button mat-icon-button style="transform: rotate(90deg)" matTooltip="Last page" (click)="scrollToEnd()">
                <mat-icon style="color: #737373">last_page</mat-icon>
            </button>
        </span> 
    </div> 
</div>

<!--
<span style="color:white">
    <ul>
        <li *ngFor="let log of logsActionListCache">
            {{ log.id }} | {{ log.datetime }} | {{ log.message }}
        </li>
    </ul>
</span>
-->
</div>