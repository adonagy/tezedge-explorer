<div class="network-action-container">

  <div class="table-virtual-scroll">
    <div class="filters-container logs-filters ">
      <!--
      <div class="active-filters-row">
        <button class="add-filters" mat-flat-button (click)="filtersState.open=true" [disabled]="filtersState.open">
          <span>
            <svg-icon icon="filter"></svg-icon>
            {{filtersState.open ? 'Active Filters' : 'ADD FILTER'}}
          </span>
        </button>

      </div>

      <mat-accordion class="filters-accordion">
        <mat-expansion-panel [expanded]="filtersState.open" hideToggle="true">
          <ng-template matExpansionPanelContent class="filters-content">
            <div class="filters-row">
              <button class="close-filters-btn" mat-flat-button (click)="filtersState.open=false">
                <span>
                  <svg-icon icon="close"></svg-icon>
                </span>
              </button>

              <span class="filters-label">
                Available Filters
              </span>
            </div>

            <div class="filters-row">
              <span class="filters-label" style="padding: 0px 14px 0px 0px; width: 51px;">Control</span>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.meta" (click)="filterType('meta')">
                Meta
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.connection"
                      (click)=" filterType('connection')">
                Connection
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.bootstrap" (click)=" filterType('bootstrap')">
                Bootstrap
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.advertise" (click)=" filterType('advertise')">
                Advertise
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.swap" (click)=" filterType('swap')">
                Swap
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.deactivate"
                      (click)=" filterType('deactivate')">
                Deactivate
              </button>

              <span class="filters-label" style="padding: 0px 8px 0px 8px; width: 40px;">Source</span>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.local" (click)=" filterType('local')">
                <span style="display:inline-block; margin: 1px 0px 0px -5px;">
                  <svg-icon icon="local" scale="0.8"></svg-icon>
                </span>
                Local
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.remote" (click)=" filterType('remote')">
                <span style="display:inline-block; margin: 1px 0px 0px -5px;">
                  <svg-icon icon="remote" scale="0.8"></svg-icon>
                </span>
                Remote
              </button>


              <span *ngIf="virtualScrollItems.urlParams" style="padding:0px 8px 0px 8px; width: 50px;">Address</span>
              <button *ngIf="virtualScrollItems.urlParams" mat-flat-button class="active" (click)="filterAddress()">
                {{ virtualScrollItems.urlParams }}
              </button>
            </div>

            <div class="filters-row">

              <span class="filters-label" style="padding:0px 6px 0px 0px; width: 60px;">Messages</span>

              <button mat-flat-button [class.active]="virtualScrollItems.filter.currentHead"
                      (click)=" filterType('currentHead')">
                Current Head
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.currentBranch"
                      (click)=" filterType('currentBranch')">
                Current Branch
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.operation" (click)=" filterType('operation')">
                Operation
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.protocol" (click)=" filterType('protocol')">
                Protocol
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.blockHeaders"
                      (click)=" filterType('blockHeaders')">
                Block Headers
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.blockOperations"
                      (click)=" filterType('blockOperations')">
                Block Operations
              </button>
              <button mat-flat-button [class.active]="virtualScrollItems.filter.blockOperationsHashes"
                      (click)=" filterType('blockOperationsHashes')">
                Block Operations Hashes
              </button>


            </div>
          </ng-template>
        </mat-expansion-panel>
      </mat-accordion>
    -->
    </div>

    <div class="table-virtual-scroll-header network-header">
      <span>DATETIME</span> <!--class="network-action-table-datetime"-->
      <span>ADDRESS</span> <!--class="network-action-table-address"-->
      <span>SOURCE</span> <!--class="network-action-table-source"-->
      <span>TYPE</span> <!--class="network-action-table-type"-->
      <span>MESSAGE</span> <!--class="network-action-table-message"-->
    </div>

    <div style="display:flex;flex-direction: row;">

      <div class="virtual-scroll-container" [class.network-filters-expanded]="filtersState.open">
        <ng-template vsFor [vsForOf]="virtualScrollItems" let-event let-position="position"
                     (getItems)="getItems($event)" (startStopDataStream)="startStopDataStream($event)">
          <span class="virtualScrollRow network-row" [style.transform]="'translate(0px,' + position + 'px)'" [class.virtualScrollRowEven]="event?.index % 2">
            <!-- (mouseenter)="tableMouseEnter(event)">-->

            <span class="item-loading" [class.displayed]="!event?.datetime">&nbsp;</span>

            <span class="truncate">{{event?.datetime}}</span>
            <span class="network-action-table-address"><a href="#/network/{{ event?.remote_addr }}"> {{ event?.remote_addr }}</a></span>
            <span>
              <span *ngIf="event?.datetime && (event?.source_type==='local' || event?.source_type==='remote')">
                <svg-icon icon="{{event?.source_type==='local' ? 'local' : 'remote'}}"></svg-icon>
                <svg-icon icon="{{event?.source_type==='local' && !event?.incoming  || event?.source_type==='remote' && event?.incoming ? 'arrow-right' : 'arrow-right'}}"></svg-icon>
                <svg-icon icon="{{event?.source_type==='local' ? 'remote' : 'local'}}"></svg-icon>
              </span>
            </span>
            <span class="truncate">
              {{event?.category}}<span *ngIf="event?.kind"> | {{ event?.kind }}</span>
            </span>

            <span class="truncate">{{event?.preview}}</span>

          </span>
        </ng-template>
      </div>

      <div class="network-action-table-detail">
        <div *ngIf="networkActionItem?.payload">
          <ngx-json-viewer [json]="networkActionItem?.payload" [expanded]="false">
          </ngx-json-viewer>
        </div>
      </div>
    </div>

    <!--        <div class="table-virtual-scroll-panel" style="display:flex;flex-direction: row;">-->

    <!--            <cdk-virtual-scroll-viewport style="align-items: flex-start;" class="table-virtual-scroll-viewport"-->
    <!--                (scrolledIndexChange)="onScroll($event)" [itemSize]="36" [maxBufferPx]="288" [minBufferPx]="288">-->

    <!--                <div *cdkVirtualFor="let even = even;let item of networkActionList" class="table-virtual-scroll-item" -->
    <!--                    [class.hover]="item?.id === networkActionItem?.id"-->
    <!--                    [class.even]="even"-->
    <!--                    (mouseenter)="tableMouseEnter(item)">-->
    <!--                    <span class="network-action-table-datetime">-->
    <!--                        {{item?.datetime}}-->
    <!--                    </span>-->
    <!--                    <span class="network-action-table-address">-->
    <!--                        <a href="#/network/{{ item?.remote_addr }}"> {{ item?.remote_addr }}</a>-->
    <!--                    </span>-->
    <!--                    <span class="network-action-table-source">-->
    <!--                        <span *ngIf="item?.source_type==='local'">-->
    <!--                            <svg-icon icon="local"></svg-icon>-->
    <!--                            <svg-icon *ngIf="!item?.incoming" icon="arrow-right"></svg-icon>-->
    <!--                            <svg-icon *ngIf="item?.incoming" icon="arrow-left"></svg-icon>-->
    <!--                            <svg-icon icon="remote"></svg-icon>-->
    <!--                        </span>-->
    <!--                        <span *ngIf="item?.source_type==='remote'">-->
    <!--                            <svg-icon icon="remote"></svg-icon>-->
    <!--                            <svg-icon *ngIf="item?.incoming" icon="arrow-right"></svg-icon>-->
    <!--                            <svg-icon *ngIf="!item?.incoming" icon="arrow-left"></svg-icon>-->
    <!--                            <svg-icon icon="local"></svg-icon>-->
    <!--                        </span> -->
    <!--                    </span>-->
    <!--                    <span class="network-action-table-type" style="white-space: nowrap; text-overflow: ellipsis;font-size:14px !important;">-->
    <!--                        {{item?.category}}<span *ngIf="item?.kind"> | {{ item?.kind }}</span>-->
    <!--                    </span>-->
    <!--                    &lt;!&ndash; <span class="network-action-table-message">-->
    <!--                    {{item?.preview}}-->
    <!--                </span> &ndash;&gt;-->
    <!--                </div>-->
    <!--            </cdk-virtual-scroll-viewport>-->

    <!--            <div class="network-action-table-detail">-->

    <!--                <div *ngIf="networkActionItem?.payload">-->
    <!--                    <ngx-json-viewer [json]="networkActionItem?.payload" [expanded]="false">-->
    <!--                    </ngx-json-viewer>-->
    <!--                </div>-->
    <!--            </div>-->

    <!--        </div>-->

    <div class="table-virtual-scroll-footer">
      <span>
        <button mat-icon-button matTooltip="Start" (click)="scrollStart(null)" *ngIf="!virtualScrollItems?.stream">
          <mat-icon>play_arrow_outline</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Stop" (click)="scrollStop()" *ngIf="virtualScrollItems?.stream">
          <mat-icon>stop_outline</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Last page" (click)="scrollToEnd()">
          <mat-icon style="transform: rotate(90deg)">last_page</mat-icon>
        </button>
      </span>
    </div>

  </div>

</div>